# Inclusive Urban Sim

포용적 주민참여를 위한 LLM 다중 에이전트 시뮬레이션: 기술적 구현에 따른 효과 비교

```
최근수정일: 26. 02. 04 17:56
작성자: 인하대학교 공간정보공학과 도시공간연구실 이태수
```

## 연구 개요

LLM 에이전트들이 도시계획 주민참여를 시뮬레이션하는 연구입니다. 기존 연구들은 단일 모델만 사용해서 의견 다양성이 부족하다는 한계가 있었는데, 이 연구에서는 **컨텍스트 분리**, **복수 모델 사용**, **사회자 에이전트 도입** 등 기술적 구현 방식을 바꿔가며 **사회적 약자 의견 반영도**에 어떤 영향을 주는지 비교합니다. 이에 따라 제가 정의한 연구 질문은 아래와 같습니다. 

### 연구 질문

1. LLM 인스턴스를 분리하면 토론이 더 다양해지는가?
2. 여러 LLM 모델을 섞어 쓰면 포용성이 증가하는가?
3. 사회자 에이전트가 약자의 발언 기회를 보장하는가?

## 실험 설계

### 본 실험 (가설 검증)

| 레벨 | 세션 | 모델 | 사회자 | 가설 | 검증 목적 |
|------|------|------|--------|------|-----------|
| **Lv.1** | 단일 | Gemini | X | - | 선행 연구 재현, 한계 확인 |
| **Lv.2** | 개별 | Gemini | X | H1 | 컨텍스트 분리 효과 |
| **Lv.3** | 개별 | 복수(5개) | X | H2 | 모델 다양화 효과 |
| **Lv.4** | 개별 | 복수(5개) | O | H3 | 사회자 역할 효과 |

**규모**: 120회 토론 (30세트 × 4레벨)

Lv.1에서 Lv.4로 갈수록 기술적 요소가 추가됩니다. 절제연구 방법론에서 영감을 받아 이를 역순으로 설계한 것인데, 각 레벨에서 포용성 지표 변화를 관찰하려 합니다. 

## 프롬프트 설계

### 1. Role Playing
 
 에이전트에게는 고유한 주민 특성과 역할이 부여됩니다. 이때 "You are not an AI"를 명시하여 역할극 성격을 강화하고 LLM이 페르소나에 몰입하도록 설계했습니다.

### 2. 지식 수준 제한

 각 에이전트는 페르소나에 기반하여 지식 수준을 제한하는 기법을 사용했습니다. "Speak only from your persona's direct experience and knowledge"와 같이 설계했는데, 이는 모든 에이전트가 전문용어를 완벽히 이해하고 논리적으로 반박하지 못하게 하기 위해서입니다.

### 3. 내면 사고 분리

  모든 에이전트는 자신의 발화와 별도로 자신의 속마음을 누적하여 저장하고 이를 바탕으로 성찰합니다. 상대방이 발언할 때 마다 왜 그렇게 말했는지, 나는 그거에 대해 어떻게 생각하는지 기록합니다. 

### 4. 지목 시스템

 발화 시 누구의 의견에 반응했는지 명시적으로 기록합니다. 공감, 비판, 인용, 질문을 통해 에이전트 간 의견 교환을 정량적으로 분석할 수 있습니다.

## 페르소나 설계

 에이전트는 찬성/반대 입장을 사전에 부여받지 않습니다. 인구통계학적 속성만으로 페르소나가 구성되며, 이를 바탕으로 스스로 입장을 형성합니다. 각 에이전트가 부여 받는 속성은 아래와 같습니다. 

```
연령대, 성별, 직업, 주거유형, 주거 소유 형태, 연소득, 거주기간, 가구구성, 재개발 지식
```
이 속성은 인천시~주안2동을 범위로 2020~2025년 사이 발표된 국가 통계와 마이크로데이터를 바탕으로 비율을 계산했습니다.

## 대상지

**인천광역시 미추홀구 주안2동**

이 곳은 주안 4동과 함께 전체 지역이 재정비촉진지구로 지정되어 있습니다. 재개발이라는 한국 고유의 도시 의제에서 관련 이해관계 충돌 현안을 다수 관찰할 수 있습니다. 선정한 대상지를 토대로 사전에 설정한 토론 의제는 아래와 같습니다. 

```
미추5구역 촉진게획 세부안에 대한 토론 및 개선 방향 도출
```

## 레포지토리 내용

### 폴더 구조

```
llm_api/        # LLM API 래퍼 (gemini, chatgpt, claude, kimi, exaone)
agent_api/      # 에이전트 시스템 (Agent, Memory, PromptBuilder)
debate/         # 토론 시뮬레이션 (DebateSimulation, 페르소나 로더, 응답 파서)
prompts/        # 프롬프트 파일 (시스템 가이드, 토론 규칙, 지역 맥락, 취약계층 페르소나)
datas/          # 통계 데이터 (인구, 주택, 소득 등)
logger/         # 로깅 시스템
outputs/        # 실험 결과 저장
tools/          # 유틸리티 스크립트
```

### 주요 파일

`main.py`는 시뮬레이션의 실행 진입점입니다. 제가 연구에서 수행한 에이전트 생성부터 토론 진행까지, 전체 흐름을 확인할 수 있습니다.

`api_price_predict.py`는 각 실험 레벨별 LLM API 비용을 사전에 예측합니다. 연구계획서 작성 단계에서 연구비 추정을 위해 작성하였으나, 혹시 있을 후속 연구자를 위해 Github에 함께 공개합니다. 

`.env.template`는 API 키와 실험 파라미터 설정을 위한
템플릿입니다. 이 파일을 `.env`로 복사한 뒤 본인의 API
키를 입력하면 됩니다.

`debate/config.py`는 페르소나 생성에 사용되는 속성별 비율과 시뮬레이션 설정값을 담고 있습니다. 각 비율은 인천시~주안2동 범위의 국가통계를 기반으로 산출되었으며, 다른 지역에 적용할 경우 해당 지역 통계 교체해야 합니다.

`prompts/debate_rule.md`는 토론 의제와 라운드별 진행 규칙을 정의합니다. 실제 미추5구역 재개발 계획안 데이터(비례율, 세대수, 분양가 등)가 포함되어 있으므로, 다른 의제를 다룰 경우 이 파일을 수정해야 합니다.

`prompts/local_context.md`는 대상지의 현황과 재개발 진행 경과를 담고 있습니다. 에이전트가 지역 맥락을 이해하는 데 사용되므로, 대상지가 바뀌면 해당 지역 정보로 교체해야 합니다.

### 기본 설정값
- 에이전트 수: 10명
- 레벨당 샘플 수: 30회
- 토론 라운드: 3라운드

### 기본 사용 모델
- gemini-3-flash-preview
- LGAI-EXAONE/K-EXAONE-236B-A23B
- kimi-k2-0905-preview
- Claude Haiku 4.5
- GPT-5 mini


## 라이센스 및 공개 범위

 본 연구에서는 후속 연구에서의 재현을 위해 다음 자료를 공개하려 합니다.

 - 에이전트 프롬프트
 - 에이전트 프로필(페르소나)
 - 토론 의제 및 대상지
 - 토론 및 분석 코드


